## IP 주소

클라이언트(100.100.100.1) - 서버 (200.200.200.2)

- 지정한 IP 주소에 데이터 전달
- 패킷이란 단위로 메시지 전달
- IP 패킷이라는 규칙이 있음

IP 패킷정보

- 출발지 IP, 목적지 IP, 메시지, 기타 가 들어있음
- 이러한 패킷정보를 클라이언트가 (패킷)에 담아 인터넷상에 던지는거임

IP 프로토콜의 한계

- 비연결성
  - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송

- 비신뢰성
  - 중간에 패킷이 사라지면?
  - 패킷이 순서대로 안오면?

- 프로그램 구분
  - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면?

대상이 서비스 불능, 패킷 전송

- 대상 서버가 패킷을 받을 수 있는 상태인지 모름

패킷 소실, 패킷 전달 순서 문제 발생(용량이 크거나 하면 나눠서 보내는데 이때 꼬일수도잇음)

이러한 문제를 해결해 주는게 TCP, UDP임

TCP, UDP

인터넷 프로토콜의 4계층

1. 애플리케이션 계층(HTTP, FTP)
2. 전송 계층(TCP, UDP)
3. 인터넷 계층(IP)
4. 네트워크 인터페이스 계층

프로토콜 계층

1. 프로그램이 Hello 메시지 생성
2. SOCKET 라이브러리를 통해 전달
3. TCP 정보 생성, 메시지 데이터 포함
4. IP 패킷 생성, TCP 데이터 포함

TCP 특징

- 연결 지향(TCP 3 WAY HANDSHAKE)
- 데이터 전달 보증(잘보냈니?(syn -> 결국 -> ack))
- 순서 보장(서버에서 패킷을 순서로 받았는지 봄1,3,2 번으로 바등면 2번부터 다시 보내라고함)
- 신뢰할 수 있는 프로토콜
- 현재는 대부분 TCP 사용

UDP(User Datagram Protocol)

- 하얀 도화지 (기능 거의없
- 연결지향아님
- 데이터 전달 보증X
- 순서 보장 X
- 신뢰 X
- 빠름

포트 - 같은 IP 내에서 프로세스 구분

한번에 둘 이상 연결해야 하면?

클라에서 게임 화상통화 웹 브라우저 요청
어떻게 구분할거여. 포트를 열어서 구분한다.

IP는 아파트, 포트는 몇동 몇호

- 0 ~ 65535 :  할당 가능
- 0 ~ 1023 : 잘 할당하지 않는 기능

IP는 변경될 수 있다

URI(Uniform Resource Identifier)

URI는 locator, name 또는 둘다 추가로 분류될 수 있다.

`http://www.google.com/search?q=hello&hl=ko`

스키마, 주로 프로토콜에 사용
프로토콜 : 어떤 방식으로 자원에 접근할 것인가 하는 약속 규칙
예) http, https, ftp 등등

`scheme://[userinfo@]host[:port][/path][?query][#fragment]`

1. DNS조회(구글서버에서)
2. 포트는 생략(찾긴함)
3. HTTP 요청 메시지 생성

`GET/ search?q=hello&hl=ko HTTP/1.1 Host:google.com`

```messgae
HTTP 메시지 전송

1. 웹 브라우저가 http 메시지 전송
2. SOCKET 라이브러리를 통해 전달

- TCP/IP 연결
- 데이터 전달

3. TCP/패킷 생성, HTTP 메시지 전달
```

4. HTTP 응답메시지

무상태 프로토콜

스테이트리스(Stateless)

서버가 클라이언트의 상태를 보존하지 않아요

Stateful(상태유지), Stateless

Stateful - 서버가 클라이언트의 상태 유지. 중간에 다른 점원으로 바뀌면 안된다.
Stateless - 서버가 클라이언트의 상태를 유지하지 않는다. 중간에 다른 점원으로 바뀌어도 된다. 제때 제때 필요한 정보를 요청하기 때문임.

무상태
로그인이 필요없는 단순한 서비스 소개 화면

상태유지
로그인

로그인한 사용자의 경우 로그인 했다는 상태를 서버에 유지
일반적으로 브라우저 쿠키와 서버 세션 등을 사용해서 상태유지
상태 유지는 최소한만 사용

연결을 계속 유지한다?
클라나 서버가 놀아도 유지해서해서 자원소모

비연결성이면 3handshake하는데 은근 시간추가
지금은 http 지속연결로 문제 해결

스테이스리스를 기억하자

서버개발자들이 어려워하는 업무

- 정말 같은 시간에 딱 맞추어 발생하는 대용량 트래픽
- 선착순 이벤트, 명절 KTX
- 순식간에 수만명 동시 요청

HTTP 메시지 구조

- 시작 라인
- 헤더
- 공백 라인
- 메시지 바디

HTTP 요청 메시지 vs 응답 메시지

- body의 필수 유무

HTTP API?

리소스의 의미는 뭘까

- 회원을 등록하고 수정하고 조회하는게 리소스가 아니다
- 회원이라는 개념 자체가 바로 리소스임.

리소스를 어떻게 식별하는게 좋을까?

- 회원을 등록하고 수정하고 조회하는 것을 모두 배제
- 회원이라는 리소스만 식별하면 된다.

API URI 설계
리소스 식별, URI 계층 구조 활용

- 회원 목록 조회 /members
- `회원` 조회 /members/{id}
- `회원` 등록 /members/{id}
- `회원` 수정 /members/{id}
- `회원` 삭제 /members/{id}
- 참고 : 계층 구조상 상위를 컬렉션으로 보고 복수단어 사용 권장(member -> members)

리소스와 행위를 분리해라 ( GET, POST )

- GET : 리소스조회
- POST : 요청 데이터 처리, 주로 등록에 사용
- PUT : 리소스를 대체, 해당 리소스가 없으면 생성
- PATCH : 리소스 부분 변경
- DELETE : 리소스 삭제

PUT 과 POST의 차이?

POST /members
PUT /members/100

PUT은 .. 너의 리소스 위치를 알고있다.(알고 있을경우)
PATCH : 리소스 부분변경

안전?

- 호출해도 리소스를 변경하지 않는다.

멱등

- 한 번 호출하든 두 번 호출하든 100번 호출하든 결과가 똑같음
- 멱등 메서드?
  - GET : 한 번 조회하든, 두 번 조회하든 같은 결과
  - PUT : 결과를 대체. 따라서 같은 요청을 여러번 해도 최종 결과는 같다.
  - DELETE : 결과를 삭제. 같은 요청을 여러번 해도 삭제된 결과는 똑같음
  - POST : 멱등이 아님. 두 번 호출하면 같은 결제가 중복해서 발생

주로 2가지 방식으로 검증한다

쿼리 파라미터를 통해(GET)

메시지 바디를 통해(POST, PUT, PATCH)

정적 데이터 조회
쿼리 파라미터 미사용

GET /static/star.jpg HTTP/1.1
Host: localhost:8080

동적 데이터 조회
쿼리 파라미터 조회

GET /search?q=hello&hl=ko HTTP/1.1
Host: www.google.com

쿼리 파라미터를 기반으로 정렬 필터해서 결과를 동적으로 생성

주로 검색, 게시판 목록에서 정렬 필터
